<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TheraFit Planner</title>
  <meta name="description" content="Build strength, reduce pain, and improve mobility with guided exercises" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="assets/css/style.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <!-- Helps the browser load fonts faster by connecting early to Google’s font -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Import Fonts -->
</head>

<body>
  <div class="app-container">
    <!-- Navbar -->
    <nav class="navbar-custom">
      <div class="navbar-container">
        <a href="index.html" class="navbar-brand">
          <img src="images/logo.png" alt="TheraFit Logo" class="brand-icon">
        </a>

        <div class="navbar-links">
          <a href="index.html" class="nav-link active">Exercises</a>
          <a href="progress.html" class="nav-link">Progress</a>
          <a href="about.html" class="nav-link">About</a>
          <button class="btn btn-sm btn-outline-secondary theme-toggle ms-2" onclick="ThemeManager.cycleTheme()">
            ☀️ Default
          </button>
        </div>
      </div>
    </nav>

    <main class="main-content">
      <header class="page-header">
        <h1 class="page-title">Fitness & Physiotherapy Exercise Planner</h1>
        <p class="page-subtitle">
          Build strength, reduce pain, and improve mobility with guided exercises
        </p>
      </header>

      <!-- Filters -->
      <section aria-label="Exercise filters" class="text-center">
        <div id="category-filters" class="category-filter">
          <!-- Populated by JS -->
        </div>
      </section>

      <!-- Exercise Grid -->
      <section aria-label="Exercise list">
        <div id="exercise-grid" class="exercise-grid">
          <!-- Populated by JS -->
        </div>
        <div id="empty-state" class="empty-state d-none">
          <p>No exercises found in this category.</p>
        </div>
      </section>

      <div class="results-count" aria-live="polite">
        Showing <span id="showing-count">0</span> of <span id="total-count">0</span> exercises
      </div>
    </main>
  </div>

  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <!-- Data -->
  <script src="assets/js/exercises.js"></script>
  <script src="assets/js/theme.js"></script>

  <!-- Page Logic -->
  <script>
    // Wait for the DOM to be fully loaded before running the script
    document.addEventListener('DOMContentLoaded', () => {
      // Get the container element where exercises will be displayed
      const grid = document.getElementById('exercise-grid');
      // Get the container element for category filter buttons
      const filtersContainer = document.getElementById('category-filters');
      // Get the element to show when no exercises match the filter
      const emptyState = document.getElementById('empty-state');
      // Get the span element to display the count of currently showing exercises
      const showingCount = document.getElementById('showing-count');
      // Get the span element to display the total number of exercises
      const totalCount = document.getElementById('total-count');

      // Initialize the current category filter to 'all' by default
      let currentCategory = 'all';

      // Generate a list of unique categories based on the exercises data
      const categories = [
        { id: 'all', label: 'All' }, // Manually add the "All" category first
        // Create a Set of unique category IDs from the exercises array
        ...[...new Set(exercises.map(ex => ex.category))].map(catId => {
          // Find the first exercise with this category ID to get its label
          const ex = exercises.find(e => e.category === catId);
          // Return an object with the category ID and its display label
          return { id: catId, label: ex.categoryLabel };
        })
      ];

      // Display the total number of exercises in the UI
      totalCount.textContent = exercises.length;

      // Loop through each category to create filter buttons
      categories.forEach(cat => {
        // Create a new button element
        const btn = document.createElement('button');
        // Set the class name, adding 'active' if it's the 'all' category
        btn.className = `filter-btn ${cat.id === 'all' ? 'active' : ''}`;
        // Set the text content of the button to the category label
        btn.textContent = cat.label;
        // Store the category ID in a data attribute
        btn.dataset.id = cat.id;
        // Set the click handler to call setCategory with this category's ID
        btn.onclick = () => setCategory(cat.id);
        // Add the button to the filters container
        filtersContainer.appendChild(btn);
      });

      // Function to render the exercises based on the current category
      function renderExercises() {
        // Clear the current content of the exercise grid
        grid.innerHTML = '';
        // Filter the exercises array based on the current category
        const filtered = currentCategory === 'all'
          ? exercises // If 'all', use all exercises
          : exercises.filter(ex => ex.category === currentCategory); // Otherwise, filter by category

        // Check if there are any exercises to display
        if (filtered.length === 0) {
          // If no exercises, show the empty state message
          emptyState.classList.remove('d-none');
        } else {
          // If there are exercises, hide the empty state message
          emptyState.classList.add('d-none');
          // Loop through each filtered exercise to create its card
          filtered.forEach(ex => {
            // Create a new anchor element for the exercise card
            const card = document.createElement('a');
            // Set the link to the exercise details page with the exercise ID
            card.href = `exercise-details.html?id=${ex.id}`;
            // Set the class name for styling
            card.className = 'exercise-card';
            // Set the inner HTML of the card with exercise details
            card.innerHTML = `
                <div class="exercise-card-header">
                    <span class="category-badge category-${ex.category}">
                        ${ex.categoryLabel}
                    </span>
                </div>
                <div class="exercise-card-image-container">
                    <img src="${ex.image}" alt="${ex.name}" class="exercise-card-img">
                </div>
                <h3 class="exercise-card-title">${ex.name}</h3>
                <div class="exercise-card-meta">
                    <span>⏱️ ${ex.duration}s</span>
                </div>
                <div class="exercise-card-btn">
                    <span class="btn btn-sm btn-secondary w-100">Start</span>
                </div>
            `;
            // Add the card to the grid container
            grid.appendChild(card);
          });
        }
        // Update the displayed count of showing exercises
        showingCount.textContent = filtered.length;
      }

      // Function to handle category selection
      function setCategory(id) {
        // Update the current category variable
        currentCategory = id;

        // Loop through all filter buttons to update their active state
        document.querySelectorAll('.filter-btn').forEach(btn => {
          // If the button's ID matches the selected ID, add the 'active' class
          if (btn.dataset.id === id) btn.classList.add('active');
          // Otherwise, remove the 'active' class
          else btn.classList.remove('active');
        });

        // Re-render the exercises grid with the new filter
        renderExercises();
      }

      // Perform the initial render of exercises when the page loads
      renderExercises();
    });
  </script>

  <footer class="bg-teal-400 text-white mt-5">
    <div class="container py-4 text-center">
      <p class="mb-1 fw-semibold">TheraFit Planner</p>
      <p class="mb-2 small">
        Contact: support@therafit.com | +60 12-345 6789
      </p>
      <p class="mb-0 small">
        <a href="about.html" class="text-white text-decoration-underline">
          About Us
        </a>
        <span class="mx-2">|</span>
        © 2026 TheraFit. All rights reserved.
      </p>
    </div>
  </footer>

</body>

</html>